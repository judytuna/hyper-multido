<html>
  <head>
    <title>My Multiple-Stage Todo List</title>
    <script src="hyper://blog.mauve.moe/slides/agregore-blog-workshop/helpers.js" type="module"></script>
    <script>
      function init() {
        document.currentGame = "";

        document.stagePopup = function(e) {
          let el = e.currentTarget;
          console.log(el.className);
          document.currentGame = el;

          let stageSelect = document.getElementById("stageSelect");
          stageSelect.style.left = e.clientX;
          stageSelect.style.top = e.clientY;
          stageSelect.removeAttribute("hidden");
        }
        document.moveToStage = async function(e, stageName) {
          let stageSelect = document.getElementById("stageSelect");
          stageSelect.hidden = true;
          let el = document.currentGame;
          el.className = "";
          el.classList.add(stageName);
          await save();
        };
      }
      init();
    </script>
    <style>
      .to-play {
        background-color: #ffffff;
        color: darkslategray;
      }
      .playing {
        background-color: rgb(122, 233, 243);
      }
      .played {
        background-color: rgb(255, 166, 166);
      }
    </style>
  </head>

  <body>
    <h1>Hello World, this is my multi-stage todo list!</h1>

    <h2>All games</h2>
    <ul>
      <li onclick="document.stagePopup(event)" class="played">Super Mario Odyssey</li>
      <li onclick="document.stagePopup(event)" class="to-play">River City Girls 1 &amp; 2</li>
      <li onclick="document.stagePopup(event)" class="playing">Ooblets</li>
    </ul>

    <button onclick="await save();">Save</button>

    <div id="stageSelect" hidden="true" style="background-color: orchid; z-index: 1000; color: #ffffff; width: 100px; position: absolute; padding-left: 16px;">
      <p onclick="document.moveToStage(event, 'to-play')">Want to play</p>
      <p onclick="document.moveToStage(event, 'playing')">Playing</p>
      <p onclick="document.moveToStage(event, 'played')">Played</p>
    </div>

  </body>
</html>